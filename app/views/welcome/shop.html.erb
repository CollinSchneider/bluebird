
<%= render partial: 'partials/shop_header' %>

<div class="container center-align">
  <%= render partial: 'partials/products_header' %>
  <div id ="products">
    <% if flash[:notice] %>
      <h5 class='red-text bold'><%= flash[:notice] %></h5>
    <% end %>
    <%= render partial: 'partials/products' %>
  </div>

  <%= will_paginate @products %>
</div>

<script>
$(document).ready(function(){
  infiniteScroll()
})

function infiniteScroll(){
  if($('.pagination').length){
    // console.log('pagination present...');
    $(window).scroll(function(){
      var url = $('.pagination .next_page').attr('href')
      if(url && $(window).scrollTop() > $(document).height() - $(window).height() - 10) {
        var gif = $('<img src = "/images/loading.gif" class="loading-gif"/>')
        $('.pagination').text('Fetching...')
        // console.log('getting?');
        $.getScript(url)
      }
    })
  }
}
</script>
